<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>File Checker</title>
        {% load static %}
        <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" />
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body class="h-100">
        <img
            class="mx-auto rounded d-block"
            style="max-width: 50%; margin-top: 5%; margin-bottom: 5%"
            src="{% static 'resources/header.png' %}"
            alt="Header image"
        />
        <div class="container h-100">
            <div class="row h-100 justify-content-center align-items-center">
                <div class="col-10 col-md-8 col-lg-6">
                    <form method="post" enctype="multipart/form-data">
                        <p class="description">
                            Upload a file or provide a valid URL to a publicly hosted file.
                        </p>
                        {% csrf_token %}

                        <div id="file_input" style="display: block">
                            <input class="form-control" type="file" name="file" id="file" />
                        </div>
                        <div id="url_input" style="display: none">
                            <input
                                class="form-control"
                                type="text"
                                name="url"
                                id="url"
                                placeholder="Enter valid URL..."
                            />
                        </div>
                        <div class="d-flex flex-row-reverse m-1">
                            <button type="submit" class="btn btn-primary m-1">Submit</button>
                            <div class="m-2">
                                <input
                                    type="radio"
                                    name="input_type"
                                    value="file"
                                    id="input_type_file"
                                    checked
                                />
                                <label for="input_type_file">Upload file</label>
                                <input
                                    type="radio"
                                    name="input_type"
                                    value="url"
                                    id="input_type_url"
                                />
                                <label for="input_type_url">Enter URL</label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- Add a div element with the "text-center" class to center the file type message -->
        <div class="text-center mt-2">
            {% if file_type %} {% for type in file_type %}
            <p>File type: {{ type.filename_extension }}</p>
            {%endfor%} {% endif %}
        </div>
        {% for item in feed %}
        <div class="card mt-3 mx-auto" style="width: 50%">
            <div class="card-body">
                <h5 class="card-title"><a href="{{ item.link }}">{{ item.title }}</a></h5>
                <p class="card-text">{{ item.summary }}</p>
                <img style="max-width: 100%" src="{{ item.picture }}" alt="{{ item.title }}" />
                <p class="card-text">
                    <small class="text-muted">{{ item.date }} | {{ item.author }}</small>
                </p>
            </div>
        </div>
        {% endfor %}
    </body>
    <script defer>
        $(document).ready(function () {
            $("input[name='input_type']").change(function () {
                if ($(this).val() == "file") {
                    $("#file_input").show();
                    $("#url_input").hide();
                } else {
                    $("#file_input").hide();
                    $("#url_input").show();
                }
            });
        });
    </script>
</html>
